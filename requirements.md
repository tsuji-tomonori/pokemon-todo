# ポケモン風TODOアプリ 要件定義書

## 1. プロジェクト概要
ポケモンの世界観を取り入れたゲーミフィケーションTODOアプリ。タスク管理を楽しく継続できるように、ポケモンバトルの要素を組み込む。

## 2. システム構成
- **フロントエンド**: React
- **バックエンド**: FastAPI
- **データベース**: PostgreSQL
- **AI**: LM Studio (microsoft/DialoGPT-medium)
- **実行環境**: Docker Compose（ローカル開発）

## 3. 主要機能

### 3.1 タスク管理機能
- **親タスク（ポケモン）**
  - タスクカテゴリーを表現
  - 名前、タイプ、レベル、経験値を持つ
  - 例：「仕事」ポケモン、「勉強」ポケモン

- **子タスク（わざ）**
  - 具体的なTODO項目
  - わざ名、威力、説明を持つ
  - 完了すると「わざを使った」扱い

### 3.2 バトルシステム
**基本仕様**: シンプルな一方向攻撃型（ターン制ではない）

- タスク完了（わざ使用）で敵に即座にダメージ
- わざの威力はタスク難易度に応じてAIが自動決定（1-100）
- 敵を倒すと経験値獲得してバトル終了
- 敵は反撃しない（ゲーム性よりシンプルさを重視）
- バトルは常に勝利で終わる（タスク完了の報酬システム）

### 3.3 成長システム
- 経験値蓄積でポケモン（親タスク）がレベルアップ
- 一定レベルで進化（ビジュアル変化）

### 3.4 AI機能
- タスク内容から難易度を推定
- わざの威力を1〜100で自動設定
- **LM Studio API使用**: `microsoft/DialoGPT-medium`モデル
- **接続先**: `http://localhost:1234`（LM Studio標準ポート）

## 4. データモデル

### Pokemon（親タスク）
- id: UUID
- name: 名前
- type: タイプ
- level: レベル
- experience: 経験値
- evolution_stage: 進化段階
- created_at: 作成日時

### Move（子タスク/わざ）
- id: UUID
- pokemon_id: 親タスクID
- name: わざ名
- description: 説明
- power: 威力（1-100）
- is_completed: 完了フラグ
- completed_at: 完了日時
- created_at: 作成日時

### Battle（バトル記録）
- id: UUID
- pokemon_id: 使用ポケモン
- enemy_name: 敵の名前
- enemy_max_hp: 敵の最大HP
- total_damage: 与えた総ダメージ
- is_victory: 勝利フラグ（常にtrue）
- experience_gained: 獲得経験値
- moves_used: 使用したわざ数
- battle_duration: バトル時間（秒）
- created_at: 作成日時

## 5. API仕様（主要エンドポイント）

### ポケモン管理
- `POST /api/pokemon` - ポケモン作成
- `GET /api/pokemon` - ポケモン一覧取得
- `PUT /api/pokemon/{id}` - ポケモン更新
- `DELETE /api/pokemon/{id}` - ポケモン削除

### わざ管理
- `POST /api/pokemon/{pokemon_id}/moves` - わざ追加
- `GET /api/pokemon/{pokemon_id}/moves` - わざ一覧取得
- `POST /api/moves/{id}/execute` - わざ実行（タスク完了＋バトル処理）
- `DELETE /api/moves/{id}` - わざ削除

### AI連携
- `POST /api/ai/calculate-power` - わざ威力自動計算
  ```json
  {
    "task_description": "プレゼン資料作成",
    "estimated_duration": "2時間"
  }
  ```

### バトル管理
- `GET /api/pokemon/{pokemon_id}/current-battle` - 現在のバトル状態取得
- `POST /api/battles/{battle_id}/complete` - バトル完了処理

## 6. UI/UX要件

### 6.1 デザインシステム

#### ビジュアルコンセプト
- **スタイル**: ネオモーフィズム × ピクセルアート × グラスモーフィズム
- **テーマ**: ダーク/ライトモード対応（システム設定連動）
- **アニメーション**: Framer Motion使用、60fps維持
- **レスポンシブ**: モバイルファースト設計

#### カラーパレット

##### プライマリカラー
```
背景:
- ライト: #F7F9FC → #E9ECEF (グラデーション)
- ダーク: #1A1D23 → #0D0F14 (グラデーション)

カード背景:
- ライト: rgba(255, 255, 255, 0.7) + backdrop-blur
- ダーク: rgba(30, 33, 40, 0.8) + backdrop-blur
```

##### ポケモンタイプ別カラー
```
ノーマル: linear-gradient(135deg, #A8A878 0%, #C6C6A7 100%)
ほのお:   linear-gradient(135deg, #F08030 0%, #F5AC78 100%)
みず:     linear-gradient(135deg, #6890F0 0%, #9DB7F5 100%)
でんき:   linear-gradient(135deg, #F8D030 0%, #FAE078 100%)
くさ:     linear-gradient(135deg, #78C850 0%, #A7DB8D 100%)
こおり:   linear-gradient(135deg, #98D8D8 0%, #BCE6E6 100%)
かくとう: linear-gradient(135deg, #C03028 0%, #D67873 100%)
どく:     linear-gradient(135deg, #A040A0 0%, #C183C1 100%)
じめん:   linear-gradient(135deg, #E0C068 0%, #EBD69D 100%)
ひこう:   linear-gradient(135deg, #A890F0 0%, #C6B7F5 100%)
エスパー: linear-gradient(135deg, #F85888 0%, #FA92B2 100%)
むし:     linear-gradient(135deg, #A8B820 0%, #C6D16E 100%)
いわ:     linear-gradient(135deg, #B8A038 0%, #D1C17D 100%)
ゴースト: linear-gradient(135deg, #705898 0%, #A292BC 100%)
ドラゴン: linear-gradient(135deg, #7038F8 0%, #A27DFA 100%)
あく:     linear-gradient(135deg, #705848 0%, #A29288 100%)
はがね:   linear-gradient(135deg, #B8B8D0 0%, #D1D1E0 100%)
フェアリー: linear-gradient(135deg, #EE99AC 0%, #F5B9C8 100%)
```

##### アクセントカラー
```
成功: #4ADE80 (緑)
警告: #FBBF24 (黄)
エラー: #F87171 (赤)
情報: #60A5FA (青)
```

#### タイポグラフィ
```
見出しフォント:
- 'DotGothic16' (日本語ピクセルフォント)
- フォールバック: 'Press Start 2P', monospace

本文フォント:
- 'Noto Sans JP'
- フォールバック: -apple-system, BlinkMacSystemFont, sans-serif

サイズスケール:
- xs: 0.75rem (12px)
- sm: 0.875rem (14px)
- base: 1rem (16px)
- lg: 1.125rem (18px)
- xl: 1.25rem (20px)
- 2xl: 1.5rem (24px)
- 3xl: 2rem (32px)
- 4xl: 2.5rem (40px)
```

#### スペーシング
```
基本単位: 8px
- xs: 4px (0.5単位)
- sm: 8px (1単位)
- md: 16px (2単位)
- lg: 24px (3単位)
- xl: 32px (4単位)
- 2xl: 48px (6単位)
- 3xl: 64px (8単位)
```

#### シャドウ
```
エレベーション:
- sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)
- md: 0 3px 6px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.12)
- lg: 0 10px 20px rgba(0,0,0,0.15), 0 3px 6px rgba(0,0,0,0.10)
- xl: 0 15px 25px rgba(0,0,0,0.15), 0 5px 10px rgba(0,0,0,0.05)

ネオモーフィズム (ライトモード):
- 凸: -8px -8px 16px #FFFFFF, 8px 8px 16px #D1D5DB
- 凹: inset -8px -8px 16px #FFFFFF, inset 8px 8px 16px #D1D5DB

ネオモーフィズム (ダークモード):
- 凸: -8px -8px 16px #2A2D35, 8px 8px 16px #0A0B0F
- 凹: inset -8px -8px 16px #2A2D35, inset 8px 8px 16px #0A0B0F
```

#### ボーダー
```
半径:
- sm: 4px
- md: 8px
- lg: 12px
- xl: 16px
- 2xl: 24px
- full: 9999px

太さ:
- thin: 1px
- medium: 2px
- thick: 4px
```

#### グリッドシステム
```
コンテナ最大幅:
- sm: 640px
- md: 768px
- lg: 1024px
- xl: 1280px
- 2xl: 1536px

グリッド列:
- モバイル: 4列
- タブレット: 8列
- デスクトップ: 12列

ガター: 16px (モバイル) / 24px (デスクトップ)
```

#### アイコン
```
ライブラリ: Phosphor Icons (太さ: regular/bold)
サイズ:
- sm: 16px
- md: 20px
- lg: 24px
- xl: 32px

ピクセルアート:
- ポケモンスプライト: 96x96px
- わざアイコン: 32x32px
- タイプバッジ: 48x24px
```

#### トランジション
```
デュレーション:
- fast: 150ms
- normal: 300ms
- slow: 500ms

イージング:
- default: cubic-bezier(0.4, 0, 0.2, 1)
- bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55)
- smooth: cubic-bezier(0.25, 0.46, 0.45, 0.94)
```

### 6.2 UIコンポーネント仕様

#### グローバル要素
- **フォント**: 見出し=Pixel風フォント、本文=Noto Sans JP
- **カード**: 浮遊感のある3Dシャドウ、ホバーで浮き上がるエフェクト
- **ボタン**: 押下時の物理的フィードバック（スケール・バウンス）
- **トースト通知**: ポケボール風アニメーション付き

#### メイン画面
- **レイアウト**: カード型グリッド（auto-fit、minmax）
- **ポケモンカード**:
  - 3Dトランスフォーム対応（傾き追従）
  - タイプ別グラデーション背景
  - レベル/経験値の円形プログレスバー
  - ピクセルアートアイコン表示
  - ホバーで詳細情報スライドイン
- **フローティングアクションボタン**: ポケボール型の追加ボタン

#### ポケモン詳細画面
- **ヘッダー**: パララックススクロール背景
- **わざリスト**:
  - スワイプ可能なカード形式
  - 威力ゲージのアニメーション表示
  - 完了時のチェックマークアニメーション
- **わざ追加モーダル**:
  - ブラー背景
  - AIが威力計算中はローディングスピナー
  - リアルタイム入力バリデーション

#### バトル画面
- **レイアウト**: 上下分割（敵/味方）
- **バトルエフェクト**:
  - パーティクルシステム（Canvas/WebGL）
  - ダメージ数値のポップアップ
  - HPバーの段階的減少アニメーション
  - 画面揺れエフェクト
- **わざ選択パネル**: 4分割グリッド、タイプ別色分け
- **勝利演出**: コンフェッティ + 経験値バー上昇アニメーション

### 6.3 インタラクション詳細

#### アニメーション
- **ページ遷移**: スライド/フェード（300ms）
- **要素出現**: スタガーアニメーション
- **ローディング**: ポケボール回転アニメーション
- **成功/エラー**: バウンス/シェイクエフェクト

#### サウンド（オプション）
- タスク完了: レトロゲーム風効果音
- レベルアップ: ファンファーレ
- ボタンクリック: 軽快なクリック音

### 6.4 UX設計原則

#### ユーザビリティ
- **直感的操作**: ドラッグ&ドロップでわざの並び替え
- **視覚的フィードバック**: 全アクションに即座の反応
- **プログレッシブディスクロージャー**: 段階的な情報開示
- **エラー防止**: 削除前の確認ダイアログ

#### ゲーミフィケーション要素
- **即時報酬**: タスク完了時の演出を豪華に
- **進捗の可視化**: 経験値バー常時表示
- **達成感の演出**: レベルアップ/進化時の特別演出
- **サプライズ要素**: ランダムでレアな敵出現

#### アクセシビリティ
- **キーボード操作**: Tab移動、Enter決定対応
- **カラーコントラスト**: WCAG AA基準準拠
- **フォーカス表示**: 明確なアウトライン
- **スクリーンリーダー**: 適切なaria-label設定

### 6.5 パフォーマンス最適化
- **遅延ローディング**: React.lazy使用
- **仮想スクロール**: 大量わざリスト対応
- **画像最適化**: WebP形式、遅延読み込み
- **アニメーション**: GPU加速（transform/opacity）

### 6.6 レスポンシブブレークポイント
- **モバイル**: 〜640px（シングルカラム）
- **タブレット**: 641px〜1024px（2カラム）
- **デスクトップ**: 1025px〜（3-4カラム）

## 7. 技術的制約
- ローカル環境での動作前提
- LM Studioは事前起動必要（ポート1234、標準設定）
- 簡素な実装優先（認証機能なし）
- バトルは必ず勝利（失敗パターンなし）

## 8. 開発優先順位
1. 基本的なCRUD機能
2. わざの威力AI判定
3. バトルシステム
4. 経験値・レベルシステム
5. UI/UXの改善

## 9. 非機能要件
- レスポンス時間: 3秒以内
- データ永続化: PostgreSQL使用
- エラーハンドリング: 適切なエラーメッセージ表示
